# ü§ñ Smart AI Agent (Custom StateGraph + Context Summarization)

–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π **AI-–∞–≥–µ–Ω—Ç** –Ω–∞ –±–∞–∑–µ **LangGraph (Custom StateGraph)** –∏ **Model Context Protocol (MCP)**.
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É —Å —è–≤–Ω—ã–º —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤–µ—Å—Ç–∏ –¥–æ–ª–≥–∏–µ –¥–∏–∞–ª–æ–≥–∏ –±–ª–∞–≥–æ–¥–∞—Ä—è **—É–º–Ω–æ–π —Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏–∏** –∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å "–º—ã—à–ª–µ–Ω–∏—è" (Chain of Thought).

–†–∞–±–æ—Ç–∞–µ—Ç –≤ **CLI** (—Ç–µ—Ä–º–∏–Ω–∞–ª —Å `rich`).

---

## üß© –ü–æ—Å–ª–µ–¥–Ω–∏–µ —É–ª—É—á—à–µ–Ω–∏—è (–∫–∞—á–µ—Å—Ç–≤–æ/—Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å)

- CLI: —É–ª—É—á—à–µ–Ω–∞ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å —Å—Ç—Ä–∏–º–∏–Ω–≥–∞ –ø—Ä–∏ –ø–æ—Ç–æ–∫–æ–≤—ã—Ö –æ—Ç–≤–µ—Ç–∞—Ö (`AIMessageChunk`).
- CLI: —É—Å–∫–æ—Ä–µ–Ω –ø–∞—Ä—Å–∏–Ω–≥ `<thought>...</thought>` (–ø—Ä–µ–¥–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π regex).
- Summarize Node: —Å–∞–º–º–∞—Ä–∏–∑–∞—Ü–∏—è —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –∫–æ–º–ø–∞–∫—Ç–Ω—ã–π –∏ –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã–π —Ç–µ–∫—Å—Ç –≤–º–µ—Å—Ç–æ –≤—ã–≤–æ–¥–∞ Python-–æ–±—ä–µ–∫—Ç–æ–≤ —Å–æ–æ–±—â–µ–Ω–∏–π.
- MCP: —Ç–∞–π–º–∞—É—Ç –∑–∞–≥—Ä—É–∑–∫–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ —Å–æ–≤–º–µ—Å—Ç–∏–º —Å Python < 3.11.
- File tools: –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –∫—Ä–æ—Å—Å–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–∫–∏ ¬´–ø–∞–ø–∫–∞ –Ω–µ –ø—É—Å—Ç–∞¬ª.

## ‚ú® –ö–ª—é—á–µ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### üß† –ò–Ω—Ç–µ–ª–ª–µ–∫—Ç –∏ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- **Custom StateGraph:** –ü—Ä–æ–∑—Ä–∞—á–Ω—ã–π –≥—Ä–∞—Ñ —Å–æ—Å—Ç–æ—è–Ω–∏–π: `Summarize` ‚Üí `Agent` ‚áÑ `Tools`.
- **Chain of Thought (CoT):** –ê–≥–µ–Ω—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–≤–æ–∏ "–º—ã—Å–ª–∏" –∏ –ø–ª–∞–Ω—ã –ø–µ—Ä–µ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º –¥–µ–π—Å—Ç–≤–∏–π (–æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –∂–µ–ª—Ç—ã–º –∫—É—Ä—Å–∏–≤–æ–º –≤ CLI).
- **–£–º–Ω–∞—è –ø–∞–º—è—Ç—å (Context Summarization):** –ü—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–∞ (`SESSION_SIZE`) —Å—Ç–∞—Ä—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è —Å–∂–∏–º–∞—é—Ç—Å—è –≤ —Å–∞–º–º–∞—Ä–∏, –ø—Ä–∏ —ç—Ç–æ–º **—Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∏–∞–ª–æ–≥–∞** (–∏—Å—Ç–æ—Ä–∏—è –≤—Å–µ–≥–¥–∞ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å API Gemini/Anthropic).
- **–î–æ–ª–≥–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –ø–∞–º—è—Ç—å (LTM):** ChromaDB + –≤–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫. –ê–≥–µ–Ω—Ç —Å–∞–º —Ä–µ—à–∞–µ—Ç, –∫–æ–≥–¥–∞ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å (`remember_fact`), –≤—Å–ø–æ–º–Ω–∏—Ç—å (`recall_facts`) –∏–ª–∏ –∑–∞–±—ã—Ç—å (`forget_fact`) –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é.

### üõ† –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∏ –†–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å
- **MCP (Model Context Protocol):** –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –ª—é–±—ã—Ö MCP-—Å–µ—Ä–≤–µ—Ä–æ–≤ (Filesystem, Search, GitHub –∏ –¥—Ä.) —á–µ—Ä–µ–∑ –∫–æ–Ω—Ñ–∏–≥ `mcp.json` —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ (`enabled`).
- **–õ–æ–∫–∞–ª—å–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:** –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤/–ø–∞–ø–æ–∫ (Sandbox).
- **–ë–µ–∑–æ–ø–∞—Å–Ω—ã–π CLI:** 
  - –°–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è –≤—ã–≤–æ–¥–∞ (—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö —Ç–µ–≥–æ–≤).
  - –°—Ç—Ä–∏–º–∏–Ω–≥ —Ç–æ–∫–µ–Ω–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ (—É—Å—Ç–æ–π—á–∏–≤–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —á–∞–Ω–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π).
  - **–û–±—Ä–∞–±–æ—Ç–∫–∞ Ctrl+C:** –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –±–µ–∑ –≤—ã–ª–µ—Ç–∞ –∏–∑ –ø—Ä–æ–≥—Ä–∞–º–º—ã.

### üîå –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã
- **CLI:** –ö—Ä–∞—Å–∏–≤—ã–π —Ç–µ—Ä–º–∏–Ω–∞–ª (`rich` + `prompt_toolkit`) —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –∏—Å—Ç–æ—Ä–∏–∏ –∫–æ–º–∞–Ω–¥, –∞–≤—Ç–æ–¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ–º –∏ —Ü–≤–µ—Ç–æ–≤–æ–π –∫–æ–¥–∏—Ä–æ–≤–∫–æ–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤.

---

## üèó –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ì—Ä–∞—Ñ–∞

–í–º–µ—Å—Ç–æ —á–µ—Ä–Ω–æ–≥–æ —è—â–∏–∫–∞, –∞–≥–µ–Ω—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ –ø—Ä–æ–∑—Ä–∞—á–Ω–æ–º—É —Ü–∏–∫–ª—É:

```mermaid
graph LR
    Start --> Summarize[üìâ –°–∂–∞—Ç–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞]
    Summarize --> Agent[ü§ñ LLM / –†–µ—à–µ–Ω–∏–µ]
    Agent -- Tool Call --> Tools[üõ† –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤]
    Tools --> Agent
    Agent -- –û—Ç–≤–µ—Ç --> End
```

1. **Summarize Node:** –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –¥–ª–∏–Ω—É –∏—Å—Ç–æ—Ä–∏–∏. –ï—Å–ª–∏ > `SESSION_SIZE`, —Å–∂–∏–º–∞–µ—Ç —Å—Ç–∞—Ä—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è, –æ—Å—Ç–∞–≤–ª—è—è –ø–æ—Å–ª–µ–¥–Ω–∏–µ **4** –¥–ª—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞.
2. **Agent Node:** –ü—Ä–∏–Ω–∏–º–∞–µ—Ç —Ä–µ—à–µ–Ω–∏–µ, —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –æ—Ç–≤–µ—Ç —Å —É—á–µ—Ç–æ–º —Å–∂–∞—Ç–æ–π –∏—Å—Ç–æ—Ä–∏–∏, —Ç–µ–∫—É—â–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –∏ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –ø—Ä–æ–º–ø—Ç–∞.
3. **Tools Node:** –í—ã–ø–æ–ª–Ω—è–µ—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã (–ø–æ–∏—Å–∫, —Ñ–∞–π–ª—ã, –ø–∞–º—è—Ç—å) –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∞–≥–µ–Ω—Ç—É.

---

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.10+ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 3.11+).

1. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ –ø—Ä–æ–µ–∫—Ç –∏ —Å–æ–∑–¥–∞–π—Ç–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ:
   
   ```bash
   python -m venv venv
   # Windows:
   venv\Scripts\activate
   # Linux/Mac:
   source venv/bin/activate
   ```

2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
   
   ```bash
   pip install -r requirements.txt
   ```

3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ `.env` (–∫–æ–ø–∏—è –∏–∑ `env_example`):
   
   ```ini
   # –ü—Ä–æ–≤–∞–π–¥–µ—Ä (Gemini –∏–ª–∏ OpenAI/Compatible)
   PROVIDER=gemini
   GEMINI_API_KEY=your_key
   GEMINI_MODEL=gemini-1.5-flash
   
   # –ü–∞–º—è—Ç—å & –ö–æ–Ω—Ç–µ–∫—Å—Ç
   LONG_TERM_MEMORY=true
   # –ü–æ—Ä–æ–≥ —Å–æ–æ–±—â–µ–Ω–∏–π, –ø–æ—Å–ª–µ –∫–æ—Ç–æ—Ä–æ–≥–æ –≤–∫–ª—é—á–∞–µ—Ç—Å—è —Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏—è
   SESSION_SIZE=15
   ```

   –ü—Ä–∏–º–µ—Ä –¥–ª—è **OpenAI** –∏–ª–∏ **OpenAI-—Å–æ–≤–º–µ—Å—Ç–∏–º—ã—Ö API** (–ø—Ä–æ–∫—Å–∏/–ª–æ–∫–∞–ª—å–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã):

   ```ini
   # –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è –Ω–∞ OpenAI-—Å–æ–≤–º–µ—Å—Ç–∏–º—ã–π –ø—Ä–æ–≤–∞–π–¥–µ—Ä
   PROVIDER=openai

   # –ö–ª—é—á (–¥–ª—è –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Å–æ–≤–º–µ—Å—Ç–∏–º—ã—Ö API –º–æ–∂–µ—Ç –±—ã—Ç—å —Ñ–∏–∫—Ç–∏–≤–Ω—ã–º, –Ω–æ –ø–æ–ª–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –∑–∞–¥–∞–Ω–æ)
   OPENAI_API_KEY=your_key

   # –ú–æ–¥–µ–ª—å (–ø—Ä–∏–º–µ—Ä: gpt-4o; –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º—ã—Ö API ‚Äî –∏–º—è –º–æ–¥–µ–ª–∏ –≤–∞—à–µ–≥–æ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞)
   OPENAI_MODEL=gpt-4o

   # –ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ: base_url –¥–ª—è OpenAI-—Å–æ–≤–º–µ—Å—Ç–∏–º—ã—Ö API
   # –ü—Ä–∏–º–µ—Ä—ã:
   # - http://localhost:11434/v1
   # - http://127.0.0.1:8000/v1
   # - https://your-proxy.example.com/v1
   OPENAI_BASE_URL=http://localhost:11434/v1

   # –ü–∞–º—è—Ç—å & –ö–æ–Ω—Ç–µ–∫—Å—Ç
   LONG_TERM_MEMORY=true
   SESSION_SIZE=15
   ```

---

## üèÉ‚Äç‚ôÇÔ∏è –ó–∞–ø—É—Å–∫

–ó–∞–ø—É—Å–∫ **CLI-–∞–≥–µ–Ω—Ç–∞**:

```bash
python agent_cli.py
```

### –ü—Ä–∏–º–µ—Ä MCP –ö–æ–Ω—Ñ–∏–≥–∞ (`mcp.json`)
–ü–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–¥–∫–ª—é—á–∞—Ç—å –≤–Ω–µ—à–Ω–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã. –ü—Ä–∏–º–µ—Ä –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã:

```json
{
  "filesystem": {
    "command": "mcp-server-filesystem",
    "args": ["{filesystem_path}"],
    "transport": "stdio",
    "enabled": true
  }
}
```

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

| –§–∞–π–ª                | –û–ø–∏—Å–∞–Ω–∏–µ                                                                 |
| ------------------- | ------------------------------------------------------------------------ |
| `agent.py`          | **–Ø–¥—Ä–æ.** –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ `StateGraph`, —É–∑–ª–æ–≤ (`summarize`, `agent`, `tools`) –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è `Pydantic`. |
| `agent_cli.py`      | **CLI.** –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π —Ü–∏–∫–ª —Å `rich`, –ø–∞—Ä—Å–∏–Ω–≥ `<thought>` —Ç–µ–≥–æ–≤, –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–π. |
| `logging_config.py` | –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è —Å –∫—Ä–∞—Å–∏–≤—ã–º –≤—ã–≤–æ–¥–æ–º —á–µ—Ä–µ–∑ `rich` –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π —à—É–º–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫. |
| `memory_manager.py` | Singleton-–º–µ–Ω–µ–¥–∂–µ—Ä –¥–æ–ª–≥–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–π –ø–∞–º—è—Ç–∏ (ChromaDB + Async Wrappers).    |
| `delete_tools.py`   | –ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —É–¥–∞–ª–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤ (sandbox).           |
| `mcp.json`          | –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è MCP-—Å–µ—Ä–≤–µ—Ä–æ–≤.                                               |
| `prompt.txt`        | –°–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç (–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ —Ñ–æ—Ä–º–∞—Ç—É –º—ã—Å–ª–µ–π, –ø—Ä–∞–≤–∏–ª–∞–º –ø–∞–º—è—Ç–∏ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏). |
| `.env`              | –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è.                                                    |

---

## üîß –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –≤ —á–∞—Ç–µ

- `exit` / `quit` ‚Äî –í—ã—Ö–æ–¥.
- `reset` / `clear` ‚Äî –ü–æ–ª–Ω—ã–π —Å–±—Ä–æ—Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ (–Ω–∞—á–∞—Ç—å –Ω–æ–≤—É—é —Å–µ—Å—Å–∏—é —Å —á–∏—Å—Ç–æ–π –∏—Å—Ç–æ—Ä–∏–µ–π –¥–∏–∞–ª–æ–≥–∞, –Ω–æ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º LTM).
- `Ctrl + C` ‚Äî –ü—Ä–µ—Ä—ã–≤–∞–Ω–∏–µ —Ç–µ–∫—É—â–µ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç–≤–µ—Ç–∞.
- `Alt + Enter` ‚Äî –ü–µ—Ä–µ–Ω–æ—Å —Å—Ç—Ä–æ–∫–∏ (–≤–≤–æ–¥ –º–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞).

---

*¬© 2025. Open-source –ø–æ–¥ MIT.*